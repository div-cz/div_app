{% extends "blog/base.html" %}

{% load i18n %}

{% block title %}Blog{% endblock title %}
{% block h1 %}{{ blog.name }} {% endblock h1 %}
{% block text_muted %} na DIV.cz{% endblock text_muted %}

{% block meta %}

{% endblock %}

{% block content %}

<div class="container">

    {% if user.is_authenticated %}
        <h2 style="width: 100%;">
            <a class="hover:underline" href="{% url 'blog_index' %}">Blogy</a>
            <span> / </span>
            <a href="">někam zpět do sekce</a>
            <span> / </span>
            {% if blog.blog_type == 'movie' %}
                Filmový blog
            {% elif blog.blog_type == 'book' %}
                Knižní blog
            {% elif blog.blog_type == 'game' %}
                Herní blog
            {% else %}
                Blog o všem
            {% endif %}
        </h2>

        <h3 style="width: 100%; margin-top: 1rem;">
            <span>„{{ blog.name }}“</span>
            <span> - </span>
            <a href="/uzivatel/{{ blog.user.id }}/">{{ blog.user.username }}</a>
        </h3>

        {% if blog.user == user %}
            <!-- Zobrazit pouze vlastníkovi blogu -->
            <a href="/blog/novy-prispevek" class="cta">
                <span>Nový příspěvek</span>
                <svg width="15px" height="10px" viewBox="0 0 13 10">
                    <path d="M1,5 L11,5"></path>
                    <polyline points="8 1 12 5 8 9"></polyline>
                </svg>
            </a>
        {% endif %}

        {% if page_obj %}
            {% for post in page_obj %}
                <div class="admin-panel">
                    <h3 class="after"><a href="/blog/{{ blog.slug }}/{{ post.slug }}">{{ post.title }}</a></h3>
                    <p>{{ post.content|striptags }}</p>
                    <small class="before" style="text-align: end;">Vydáno: {{ post.published_at }}</small>
                </div>
            {% endfor %}
            

            <!-- paginátor -->
            <div class="pagination">
                <span class="step-links">
                    {% if page_obj.has_previous %}
                        <a class="first-page" href="?page=1">&laquo; První</a>
                        <a href="?page={{ page_obj.previous_page_number }}">Předchozí</a>
                    {% endif %}

                    <span class="current-page">
                        {{ page_obj.number }} / {{ page_obj.paginator.num_pages }}
                    </span>

                    {% if page_obj.has_next %}
                        <a href="?page={{ page_obj.next_page_number }}">Další</a>
                        <a class="last-page" href="?page={{ page_obj.paginator.num_pages }}">Poslední &raquo;</a>
                    {% endif %}
                </span>
            </div>

            <a href="/forum/" class="btn add-other">Diskuzní fórum</a>

            {% else %}
                <p>Zatím žádné příspěvky.</p>
        {% endif %}

        {% else %}

        <!-- NE přihlášen -->
        <small style="color:silver">Po přihlášení si můžeš založit blog</small>

        <hr>

        <ul>
            {% for post in page_obj %}
            <li class="card-body border mb-2 rounded-1xl">
                <h3><a href="/blog/{{ blog.slug }}/{{ post.slug }}">{{ post.title }}</a></h3>
                <p>{{ post.content|striptags }}</p>
                <small>Vydáno: {{ post.published_at }}</small>
            </li>
            {% endfor %}
        </ul>
                
        <hr>
        <a href="/blogy/">Všechny blogy</a> | <a href="/forum/">Diskuzní fórum</a>
        <hr>
            
    {% endif %}
</div>

{% endblock content %}