{% extends "games/base.html" %}
{% load i18n %}
{% load ratings %}
{% load static %}

{% block title %}Hry na DIV.cz{% endblock %}

{% block meta %}

    <meta name="description" content="Objevte svět her na DIV.cz. Nejnovější hry, recenze, žebříčky a informace o všech herních platformách.">
    <meta name="keywords" content="hry, videohry, recenze her, herní platformy, Playstation, Xbox, Nintendo, online hry, deskové hry">
    <meta name="author" content="DIV.cz">

    <meta property="og:title" content="Hry | Databáze DIV.cz">
    <meta property="og:description" content="Prozkoumejte nejnovější hry, recenze a žebříčky na DIV.cz. Vše o herních platformách a novinkách ze světa her.">
    <meta property="og:image" content="https://div.cz/img/game/herni-div.webp">
    <meta property="og:url" content="https://div.cz/hry/">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Hry | Databáze DIV.cz">
    <meta name="twitter:description" content="Aktuální databáze her na DIV.cz. Recenze, novinky, platformy a více.">
    <meta name="twitter:image" content="https://div.cz/img/game/herni-div.webp">

    <style>
        .rating {
            position: relative;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            margin-top: 0;
            margin-right: 0;
            margin-bottom: 0;
            padding: 0;
            box-shadow: 0px 8px 16px rgb(147 147 147);
        }

        .rating::before {
            content: '';
            position: absolute;
            top: 3px;
            left: 3px;
            width: 44px;
            height: 44px;
            background: #444444;
            border-radius: 50%;
            z-index: 2;
            margin: 0;
        }

        .rating::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 50px;
            height: 50px;
            background: conic-gradient(
                var(--gradient-color, #0a0) 0%,
                var(--gradient-color, #0a0) var(--gradient-value, 50%),
                #777777 var(--gradient-value, 50%)
            );
            border-radius: 50%;
            z-index: 1;
            margin: 0;
        }

        .rating-inner {
            position: relative;
            z-index: 3;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #fff;
            font-size: 16px;
            font-weight: bold;
            /* margin-top: 10px;
            margin-right: -10px; */
        }

        .rating-inner span {
            font-size: 10px;
            margin-left: 2px;
            color: #ffd700;
        }

        .rating:is(.dark *) {
            box-shadow: none;
        }
    </style>

{% endblock %}

{% block content %}

<div class="container">
    
    <!-- LEVÁ STRANA -->
    <div class="left-side">
        <!-- carousel -->
        <div class="expandable">
            {% for game in carousel_games %}
                <div class="panel {% if forloop.first %}active{% endif %} border box-shadow" style="background-image: url('{% if game.img == "rawg.io" %}https://rawg.io/img/{{ game.img }}{% elif game.img %}https://media.div.cz/hry{{ game.img }}{% else %}/static/img/game/game.png{% endif %}')">
                    <!--<a href="/hra/{{ game.url }}"><h3>{{ game.title }}</h3></a>-->
                </div>
            {% endfor %}
        </div>

        {% if messages %}
            <div style="margin-top: .75rem;">
                {% for message in messages %}
                    <div class="alert alert-{{ message.tags }}" role="alert">
                        {{ message|safe }}
                    </div>
                {% endfor %}
            </div>
        {% endif %}

        <!-- generování her -->
        <div style="margin-bottom: 1rem;">

            <!-- TABS / PLATFORMY -->
            <ul class="tab-profile-container">
                <li class="tab active">
                    <a href="">Vše</a>
                </li>
                <li class="tab">
                    <a href="">PS5</a>
                </li>
                <li class="tab">
                    <a href="">PS4</a>
                </li>
                <li class="tab">
                    <a href="">PC</a>
                </li>
                <li class="tab">
                    <a href="">xBox</a>
                </li>
                <li class="tab">
                    <a href="/games_charts.html">další</a>
                </li>

                <div class="background"></div>
            </ul>

            <!-- VÝPIS HER -->
            <div class="game-list-wrapper">
                {% for game in games %}
                    <div class="game-card-item">
                        <a href="/hra/{{ game.url }}" style="width: 130px;">
                            {% if game.img %}
                                {% if game.img == "rawg.io" %}
                                    <img src="https://rawg.io/ ... ... .../{{ game.img }}" alt="{{ game.title }}" class="card-img-top game-card-image">
                                {% else %}
                                    <img src="https://media.div.cz/hry/{{ game.img }}" alt="{{ game.title }}" class="card-img-top game-card-image">
                                {% endif %}
                            {% else %}
                                <img src="/static/img/game/game.png" alt="{{ game.title }}" class="card-img-top game-card-image">
                            {% endif %}
                        </a>

                        <div class="card-body" style="width: min-content;">
                            <div class="card-header">
                                <div>
                                    <h4 class="card-title">
                                        <a href="/hra/{{ game.url }}">{{ game.title }}</a> ({{ game.year }})
                                    </h4>
                                    <div class="game-tags-row">
                                        <span class="tag-label">
                                            <a href="" style="color: #fff;">Štítek</a>
                                        </span>
                                    </div>
                                </div>

                                <!-- hodnocení -->
                                <div class="rating-wrapper" style="width: 50px;">
                                    <div class="rating" data-rating="{{ game.average_rating }}">
                                        <div class="rating-inner">{{ game.average_rating }}%</div>
                                    </div>
                                </div>
                            </div>

                            <p class="card-text">
                                {% if game.descriptioncz %}
                                    {{ game.descriptioncz|safe }}
                                {% else %}
                                    {{ game.description|safe }}
                                {% endif %}
                            </p>
                        </div>
                    </div>
                {% endfor %}
            </div>
        </div>

        <!-- Poslední herní recenze -->
        <div class="card reviews-card">
            <div class="card-body">
                <div class="reviews-header card-title after-h3">
                    <h3>&#128221;&#65039; Poslední herní recenze</h3>
                </div>
                <div class="reviews-list after last-line"> 
                    {% if latest_comments %} 
                        {% for comment in latest_comments %}   
                            <div class="review-item"> 
                                <div class="review-thumb-wrapper"> 
                                    {% if game.img %}
                                        {% if game.img == "rawg.io" %}
                                            <img src="/img/{{ game.img }}" alt="{{ game.title }}" class="img-fluid review-thumb">
                                        {% else %}
                                            <img src="https://media.div.cz/hry/{{ game.img }}" alt="{{ game.title }}" class="img-fluid review-thumb">
                                        {% endif %}

                                    {% else %}
                                        <img src="/static/img/game/game.png" alt="{{ game.title }}" class="img-fluid review-thumb">
                                    {% endif %}
                                </div>    

                                <div class="review-content" style="flex: 2;"> 
                                    <div class="review-main">
                                        <a class="review-title" href="{% url 'game_detail' comment.gameid.url %}">{{ comment.gameid.titlecz }}</a>
                                        <p class="review-text">{{ comment.comment }}</p>
                                    </div>
                                    
                                    <div class="review-meta" style="font-size: small;"> 
                                        <p>Uživatel:
                                            {% if comment.user %}
                                                <a href="/uzivatel/{{ comment.user.id }}/">{{ comment.user.username }}</a>
                                            {% endif %}
                                        </p>
                                        <span class="review-date">| {{ comment.dateadded|date:"d.m.Y H:i" }}</span>
                                    </div>
                                </div>
                            </div> 

                            {% if not forloop.last %}
                                <hr class="review-divider">
                            {% endif %}
                        {% endfor %}
                        
                        {% else %}
                        <p>Zatím žádné recenze od komunity.</p>
                    {% endif %}
                </div>
            </div>
        </div>   

    </div>
    
    <!-- PRAVÁ STRANA -->
    <div class="right-side">
        <!-- brzy vyjde -->
        <div class="card">
            <div class="card-body">
                <h3 class="card-title after-h3">&#127381; Právě vyšlo</h3>
                <ul style="width: 100%;" style="list-style-type:none">
                    <li><a href="/hra/grand-theft-auto-vi">GTA VI.</a></li>
                    <li><a href="/hra/doom-the-dark-ages">DOOM</a></li>
                    <li><a href="/hra/ceske-legendy" title="Nejlepší česká deskovka">České legendy</a></li>
                    <li><a href="/hra/the-wolf-among-us-2">The Wolf Among Us 2</a></li>
                    <li><a href="/hra/assassin-s-creed-shadows">Assassin's Creed Shadows</a></li>
                    <li><a href="/hra/monster-hunter-wilds">Monster Hunter Wilds</a></li>
                    <li><a href="/hra/kingdom-come-deliverance-ii">Kingdom Come: Deliverance II</a></li>
                    <li><a href="/hra/avowed">Avowed</a></li>
                    <li><a href="/hra/prince-of-persia-the-sands-of-time-remake">Prince of Persia</a></li>
                </ul>
            </div>
        </div>

        <!-- BURZA HER -->
        <div class="card">
            <div class="card-body">
                <div class="market-header card-title after-h3">
                    <h3 class="market-title">&#128717; Burza her</h3>
                </div>

                <!-- prodej -->
                <div class="market-section">
                    <div class="market-section-header">
                        <h4>Prodej</h4>
                        <div>
                            <a href="#"><small>Zobrazit vše</small></a> | 
                            <a href="#"><small>Zobrazit moje</small></a>
                        </div>
                    </div>

                    <div class="market-item">
                        <a href="#">
                            <img src="" alt="" class="market-thumb">
                        </a>
                        <div class="market-content">
                            <p class="market-line"><a href="#">Název hry</a></p>
                            <p class="market-line">150 Kč</p>
                            <p class="market-meta">
                                <small>Přidal: <a href="#">Uživatel123</a> | 31.8.2025</small>
                            </p>
                        </div>
                    </div>
                </div>

                <hr>

                <!-- poptávka -->
                <div class="market-section">
                    <div class="market-section-header">
                        <h4>Poptávka</h4>
                        <div>
                            <a href="#"><small>Zobrazit vše</small></a> | 
                            <a href="#"><small>Zobrazit moje</small></a>
                        </div>
                    </div>

                    <div class="market-item">
                        <a href="#">
                            <img src="" alt="" class="market-thumb">
                        </a>
                        <div class="market-content">
                            <p class="market-line"><a href="#">Hledaná hra</a></p>
                            <p class="market-line">Daruji</p>
                            <p class="market-meta">
                                <small>Přidal: <a href="#">Uživatelka</a> | 28.8.2025</small>
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ČLÁNKY -->
        <div class="card">
            <div class="card-body">
                <div class="card-title after-h3">
                    <h3>&#128240;&#65039; Články</h3>
                    <a href="{% url 'articles_list' category='hry' %}"><small>Zobrazit vše</small></a>
                </div>
                <div class="article-head-title after">
                    <a href="https://div.cz/the-game-awards">The Game Awards</a>
                </div>
                <div class="text-right">
                    {% if user.is_superuser %}
                        <a href="{% url 'article_new' category=category_key %}"><i class="fa-solid fa-plus"></i> Přidat nový článek</a>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- ŽÁNRY -->
        <div class="card">
            <div class="card-body">
                <h3 class="card-title after-h3">&#127917; Žánry</h3>
                <div>
                    <a href="/hry/zanr/akcni">Akční</a> |
                    <a href="/hry/zanr/dobrodruzny">Dobrodružný</a> |
                    <!--<a href="/hry/zanr/detske">Dětské</a> |-->
                    <a href="/hry/zanr/horor">Horor</a> |
                    <a href="/hry/zanr/indie">Indie</a> |
                    <a href="/hry/zanr/hudebni">Hudební</a> |
                    <!--<a href="/hry/zanr/logicke">Logické</a> |-->
                    <a href="/hry/zanr/moba">MOBA</a> |
                    <!--<a href="/hry/zanr/online">Online</a> |-->
                    <a href="/hry/zanr/rpg">RPG</a> |
                    <!---->
                    <a href="/hry/zanr/simulace">Simulátory</a> |
                    <a href="/hry/zanr/sportovni">Sportovní</a> |
                    <a href="/hry/zanr/strategie">Strategie</a> |
                    <a href="/hry/zanr/strilecka">Střílečka</a> |
                    <a href="/hry/zanr/zavodni">Závodní</a> 
                </div>
            </div>
        </div>
        
        <!-- ROKY -->
        <div class="card">
            <div class="card-body">
                <h3 class="card-title after-h3">&#128467;&#65039; Roky</h3>
                <div>
                    <a href="/hry/rok/2024">2024</a> |
                    <a href="/hry/rok/2023">2023</a> |
                    <a href="/hry/rok/2022">2022</a> |
                    <a href="/hry/rok/2021">2021</a> |
                    <a href="/hry/rok/2020">2020</a> |
                    <a href="/hry/rok/2019">2019</a> |
                    <a href="/hry/rok/2018">2018</a> |
                    <a href="/hry/rok/2017">2017</a> |
                    <a href="/hry/rok/2016">2016</a> |
                    <a href="/hry/rok/2015">2015</a> |
                    <a href="/hry/rok/2014">2014</a> |
                    <a href="/hry/rok/2013">2013</a> |
                    <a href="/hry/rok/2012">2012</a> |
                    <a href="/hry/rok/2011">2011</a> |
                    <a href="/hry/rok/2010">2010</a> |
                    <a href="/hry/rok/2009">2009</a> |
                    <a href="/hry/rok/2008">2008</a> |
                    <a href="/hry/rok/2007">2007</a> |
                    <a href="/hry/rok/2006">2006</a> |
                    <a href="/hry/rok/2005">2005</a> |
                    <a href="/hry/rok/2004">2004</a> |
                    <a href="/hry/rok/2003">2003</a> |
                    <a href="/hry/rok/2002">2002</a> |
                    <a href="/hry/rok/2001">2001</a>

                    <details>
                        <summary>Další roky</summary>
                        <a href="/hry/rok/2000">2000</a> |
                        <a href="/hry/rok/1999">1999</a> |
                        <a href="/hry/rok/1998">1998</a> |
                        <a href="/hry/rok/1997">1997</a> |
                        <a href="/hry/rok/1996">1996</a> |
                        <a href="/hry/rok/1995">1995</a> |
                        <a href="/hry/rok/1994">1994</a> |
                        <a href="/hry/rok/1993">1993</a> |
                        <a href="/hry/rok/1992">1992</a> |
                        <a href="/hry/rok/1991">1991</a> |
                        <a href="/hry/rok/1990">1990</a> |
                        <a href="/hry/rok/1989">1989</a> |
                        <a href="/hry/rok/1988">1988</a> |
                        <a href="/hry/rok/1987">1987</a> |
                        <a href="/hry/rok/1986">1986</a> |
                        <a href="/hry/rok/1985">1985</a> |
                        <a href="/hry/rok/1984">1984</a> |
                        <a href="/hry/rok/1983">1983</a> |
                        <a href="/hry/rok/1982">1982</a> |
                        <a href="/hry/rok/1981">1981</a> |
                        <a href="/hry/rok/1980">1980</a> |
                        <a href="/hry/rok/1979">1979</a> |
                        <a href="/hry/rok/1978">1978</a> |
                        <a href="/hry/rok/1977">1977</a> |
                        <a href="/hry/rok/1976">1976</a> |
                        <a href="/hry/rok/1975">1975</a> |
                        <a href="/hry/rok/1974">1974</a> |
                        <a href="/hry/rok/1973">1973</a> |
                        <a href="/hry/rok/1972">1972</a> |
                        <a href="/hry/rok/1971">1971</a> |
                        <a href="/hry/rok/1970">1970</a> |
                        <a href="/hry/rok/1969">1969</a> |
                        <a href="/hry/rok/1968">1968</a> |
                        <a href="/hry/rok/1967">1967</a> |
                        <a href="/hry/rok/1966">1966</a> |
                        <a href="/hry/rok/1965">1965</a> |
                        <a href="/hry/rok/1964">1964</a> |
                        <a href="/hry/rok/1963">1963</a> |
                        <a href="/hry/rok/1962">1962</a> |
                        <a href="/hry/rok/1961">1961</a> |
                        <a href="/hry/rok/1960">1960</a> |
                        <a href="/hry/rok/1959">1959</a> |
                        <a href="/hry/rok/1958">1958</a> 
                    </details>
                </div>
            </div>
        </div>

        <!-- STATISTIKY -->
        <div class="card">
            <div class="card-body">
                <h3 class="card-title after-h3">&#128202;&#65039; Herní statistiky DIV</h3>
                <ul>
                    <li><p>89.564 her</p></li>
                    <!--<li>--><!--počet--><!--<p>her na PC</p></li>-->
                    <!--<li>--><!--počet--><!--<p>her na PS</p></li>-->
                    <!--<li>--><!--počet--><!--<p>her na Xbox</p></li>-->
                    <!--<li>--><!--počet--><!--<p>stolních her</p></li>-->
                </ul>
            </div>
        </div>

    </div>
</div>


<!-- KARTY -->
<script>
    function updateGroupSelector(active) {
        const parent = document.querySelector('.tab-profile-container');
        const background = parent.querySelector('.background');

        // Najdeme pozici aktivní karty
        const activeRect = active.getBoundingClientRect();
        const parentRect = parent.getBoundingClientRect();

        // Vypočítáme relativní pozici a šířku
        const left = activeRect.left - parentRect.left;
        const width = activeRect.width;

        // Nastavíme nové vlastnosti pozadí
        background.style.transform = `translateX(${left}px)`;
        background.style.width = `${width}px`;

        // Aktualizujeme aktivní kartu
        parent.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
        active.classList.add('active');
    }

    // Inicializace při načtení stránky
    window.addEventListener('DOMContentLoaded', () => {
        const initialTab = document.querySelector('.tab.active');
        if (initialTab) {
            updateGroupSelector(initialTab);
        }
    });
</script>

{% endblock %}

