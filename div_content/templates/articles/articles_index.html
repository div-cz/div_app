{% extends "articles/base.html" %}
{% load i18n %}
{% load ratings %}
{% load static %}

{% block title %}Články | Databáze DIV{% endblock title %}

{% block meta %}

    <link href="/web/css/navbar_together.css" rel="stylesheet">

{% endblock %}

{% block content %}

<div class="big-search">
    <h2>Články</h2>
    <form role="search" action="{% url 'forum_search' %}" method="get">
        <input class="search-field" type="type" placeholder="Hledat článek" aria-label="Search" name="q" id="search-input">
        <button class="btn-search" type="submit">Hledat</button>
    </form>
</div>

<div class="articles">
    <div class="talk-img" style="background-image: url(/static/img/articles/article.webp); background-size: 100% 100%;">
        <a href="/clanky/filmy/" class="movies">
            <img src="/static/img/forum/movie.webp" alt="Filmové články">
            <h3 class="movies">Filmové články</h3>
        </a>
    </div>

    <div class="talk-img" style="background-image: url(/static/img/articles/article.webp);
    background-size: 100% 100%;">
        <a href="/clanky/serialy/" class="movies">
            <img src="/static/img/forum/serie.webp" alt="Seriálové články">
            <h3 class="movies">Seriálové články</h3>
        </a>
    </div>

    <div class="talk-img" style="background-image: url(/static/img/articles/article.webp);
    background-size: 100% 100%;">
        <a href="/clanky/knihy/" class="books">
            <img src="/static/img/forum/book.webp" alt="Knižní články">
            <h3 class="books">Knižní články</h3>
        </a>
    </div>

    <div class="talk-img" style="background-image: url(/static/img/articles/article.webp);
    background-size: 100% 100%;">
        <a href="/clanky/hry/" class="games">
            <img src="/static/img/forum/game.webp" alt="Herní články">
            <h3 class="games">Herní články</h3>
        </a>
    </div>
</div>


<!-- Poslední články -->
<div class="latest-posts">
    <h3 class="latest-title">&#128204; Poslední články</h3>

    {% if latest_articles %}
        {% for art in latest_articles %}
            <div class="last-post-card">

                <div class="lp-header">
                    <a class="lp-title" href="/{{ art.url }}">
                        {{ art.title }}
                    </a>

                    {% if art.typ == "Movie" %}
                        <span class="movies">&#127916; Filmy</span>
                    {% elif art.typ == "Book" %}
                        <span class="books">&#128214; Knihy</span>
                    {% elif art.typ == "Game" %}
                        <span class="games">&#127918; Hry</span>
                    {% elif art.typ == "Series" %}
                        <span class="series">&#128253; Seriály</span>
                    {% else %}
                        <span class="general">&#128172; Ostatní</span>
                    {% endif %}
                </div>

                <div class="lp-body">
                    {% if art.img400x250 %}
                        <img
                            src="{{ art.img400x250 }}"
                            alt="{{ art.alt }}"
                            class="lp-image"
                        >
                    {% endif %}

                    <p class="lp-perex">
                        {{ art.perex|default:art.content|striptags|truncatechars:140 }}
                    </p>
                </div>

                <div class="lp-footer">
                    <span>{{ art.created|date:"d.m.Y" }}</span>
                </div>

            </div>
        {% endfor %}
    {% else %}
        <p>Zatím žádné články.</p>
    {% endif %}
</div>


<script>
    // Funkce pro zobrazení/skrytí roletového menu po kliknutí na text "Akce"
    function toggleDropdown(event) {
        var dropdown = document.getElementById('action-dropdown');
        dropdown.style.display = (dropdown.style.display === 'none' || dropdown.style.display === '') ? 'flex' : 'none';
        
        // Zastavíme šíření události, abychom zabránili jejímu zachycení dokumentem
        event.stopPropagation();
    }

    // Funkce pro zavření nabídky, pokud uživatel klikne někam mimo pole
    document.addEventListener('click', function(event) {
        var dropdown = document.getElementById('action-dropdown');
        if (!dropdown.contains(event.target)) {
            dropdown.style.display = 'none';
        }
    });
</script>

{% endblock %}