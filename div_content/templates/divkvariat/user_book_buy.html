{% extends "divkvariat/base.html" %}
{% load humanize %}

{% block title %}
{{ profile_user.username }} – Poptávky knih | DIVkvariát
{% endblock %}

{% block content %}

<div class="page page-wide">
    <h1 class="page-title">
        {{ profile_user.username }} – Poptávky knih
    </h1>

    {% if avg_rating %}
        <div class="user-rating">
            <strong>{{ avg_rating|floatformat:1 }}/5</strong>
            <span class="user-rating-stars">
                {% for i in "12345"|make_list %}
                    {% if forloop.counter <= avg_rating %}★{% else %}☆{% endif %}
                {% endfor %}
            </span>
            <span class="user-rating-count">
                ({{ total_ratings }} hodnocení)
            </span>
        </div>
    {% endif %}

    <a href="/poptavky/" class="back-link">
        ← Všechny poptávky
    </a>

    <div class="listing-grid">

        {% for listing in listings %}
            <div class="listing-card">

                <h3 class="listing-title">
                    {{ listing.book.titlecz|default:listing.book.title }}
                </h3>

                <p class="listing-author">
                    {{ listing.book.author }}
                </p>

                <p class="listing-price">
                    Nabízím {{ listing.price|intcomma }} Kč
                </p>

                {% if listing.location %}
                    <p class="listing-location">
                        Lokalita: {{ listing.location }}
                    </p>
                {% endif %}

                <p class="listing-date">
                    {{ listing.createdat|naturaltime }}
                </p>

                <a href="{% url 'listing_detail_buy' listing.book.url listing.booklistingid %}"
                class="btn-primary btn-block">
                    Detail poptávky
                </a>

            </div>

            {% empty %}
            <p class="empty-state">
                Žádné aktivní poptávky.
            </p>
        {% endfor %}

    </div>
</div>

{% endblock %}
