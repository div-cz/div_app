{% extends "divkvariat/base.html" %}
{% load static %}

{% block title %}M콢j 칰캜et | DIVkvari치t{% endblock %}

{% block content %}

<div class="page page-wide">
    <!-- HLAVI캛KA -->
    <div class="content-box content-box-flex">
        <div>
            <h1 class="page-title">M콢j 칰캜et</h1>
            <p class="text-muted">
                P콏ihl치코en jako <strong>{{ user.username }}</strong>
                {% if user.first_name or user.last_name %}
                    ({{ user.first_name }} {{ user.last_name }})
                {% endif %}
            </p>
        </div>

        <div class="button-group">
            <a href="{% url 'user_book_listings' user.id %}" class="btn-primary">
                游닍 Spravovat moje nab칤dky
            </a>
            <a href="{% url 'account_edit' %}" class="btn-primary">
                Upravit 칰daje
            </a>
        </div>

    </div>

    <!-- DIVCOINY -->
    <div class="content-box">
        <h2 class="section-title">游눯 DIVcoiny</h2>
        <p class="text-muted">
            DIVcoiny z칤sk치v치코 hlavn캩 za <strong>prodej a n치kup knih</strong> na DIVkvari치tu,
            ale tak칠 za <strong>hodnocen칤 knih na DIV.cz</strong> a dal코칤 aktivity.
        </p>

        <div class="stats-grid">
            <div class="stat-box">
                <span class="stat-label">Tento t칳den</span>
                <span class="stat-value">{{ coins.weeklydivcoins|default:0 }}</span>
                <span class="stat-unit">DIVcoiny</span>
            </div>

            <div class="stat-box">
                <span class="stat-label">Tento m캩s칤c</span>
                <span class="stat-value">{{ coins.monthlydivcoins|default:0 }}</span>
                <span class="stat-unit">DIVcoiny</span>
            </div>

            <div class="stat-box">
                <span class="stat-label">Tento rok</span>
                <span class="stat-value">{{ coins.yearlydivcoins|default:0 }}</span>
                <span class="stat-unit">DIVcoiny</span>
            </div>

            <div class="stat-box stat-box-highlight">
                <span class="stat-label">Celkem</span>
                <span class="stat-value-big">{{ coins.totaldivcoins|default:0 }}</span>
                <span class="stat-unit">DIVcoiny</span>
            </div>

        </div>
    </div>

    <!-- STATISTIKY -->
    <div class="content-box">
        <h2 class="section-title">游닄 P콏ehled aktivit</h2>
        <div class="stats-grid">
            <div class="stat-box">
                <span class="stat-label">Prodan칠 knihy</span>
                <span class="stat-value">{{ sold_books }}</span>
            </div>

            <div class="stat-box">
                <span class="stat-label">Zakoupen칠 knihy</span>
                <span class="stat-value">{{ bought_books }}</span>
            </div>

            <div class="stat-box">
                <span class="stat-label">Aktivn칤 nab칤dky</span>
                <span class="stat-value">{{ active_sell_count }}</span>
            </div>

            <div class="stat-box">
                <span class="stat-label">Aktivn칤 popt치vky</span>
                <span class="stat-value">{{ active_buy_count }}</span>
            </div>

        </div>
    </div>

    <!-- POSLEDN칈 NAB칈DKY / POPT츼VKY -->
    <div class="content-grid-2">
        <div class="content-box">
            <h3 class="section-subtitle">游닍 Moje aktivn칤 nab칤dky</h3>

            {% if active_sell_list %}
                <ul class="simple-list">
                    {% for listing in active_sell_list %}
                        <li>
                            <span>
                                {{ listing.book.titlecz|default:listing.book.title }}
                                <span class="text-muted">({{ listing.book.author }})</span>
                            </span>
                            <strong>{{ listing.price }} K캜</strong>
                        </li>
                    {% endfor %}
                </ul>

                <a href="{% url 'user_book_listings' user.id %}" class="btn-primary">
                    游닍 V코echny moje nab칤dky
                </a>

                {% else %}
                <p class="text-muted">Nem치코 쮂멳n칠 aktivn칤 nab칤dky.</p>
            {% endif %}
        </div>

        <div class="content-box">
            <h3 class="section-subtitle">游댌 Moje aktivn칤 popt치vky</h3>

            {% if active_buy_list %}
                <ul class="simple-list">
                    {% for listing in active_buy_list %}
                        <li>
                            <span>
                                {{ listing.book.titlecz|default:listing.book.title }}
                                <span class="text-muted">({{ listing.book.author }})</span>
                            </span>
                            <strong>{{ listing.price }} K캜</strong>
                        </li>
                    {% endfor %}
                </ul>

                {% else %}
                <p class="text-muted">Nem치코 쮂멳n칠 aktivn칤 popt치vky.</p>
            {% endif %}
        </div>

    </div>

    <!-- ODHLAEN칈 -->
    {% if request.user.is_authenticated %}
        <div class="centered mt-lg">
            <a href="/odhlaseni/" class="link-danger">
                Odhl치sit se
            </a>
        </div>
    {% endif %}

</div>

{% endblock %}
