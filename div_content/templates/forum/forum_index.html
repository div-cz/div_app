{% extends "forum/base.html" %}
{% load i18n %}
{% load ratings %}
{% load static %}

{% block title %}Div.cz | Diskuzní fórum{% endblock title %}

{% block content %}

<link href="https://media.div.cz/css/navbar_together.css" rel="stylesheet">

<h2 class="w-full">Diskuzní fórum</h2>
<form class="d-flex mt-4" style="max-width: 400px;" role="search" action="{% url 'forum_search' %}" method="get">
    <input class="password-field" type="type" placeholder="Hledat na fóru" aria-label="Search" name="q" id="search-input">
    <button class="mb-4 btn-action add" style="margin: 0 5px;" type="submit">Hledat</button>
</form>

<div class="grid gap-5 lg:grid-cols-4 md:grid-cols-3 sm:grid-cols-2 mt-5">
{% for section in all_forum_sections %}
    <div class="card-body w-full items-center text-center" style="background-image: url(/static/img/forum/bubble.webp); background-size: 100% 100%;">
        <a href="{% url 'forum_section_detail' slug=section.slug %}">
            <img src="/static/img/forum/{{section.imageurl}}">
            <h3 class="{{ section.description }}">{{ section.title }}</h3>
        </a>
    </div>
{% endfor %}
</div>



<h3 class="mt-10 mb-3">📌 Poslední příspěvky</h3>

<section class="my-4 w-3/4">
    {% if latest_comments %}
        {% for comment in latest_comments %}
        <ol class="border mb-2">
            <!-- Titulek vlákna -->
            <li class="flex justify-between">
                <a class="hover:underline font-semibold" 
                   href="{% url 'forum_topic_detail' slug=comment.topic.section.slug topicurl=comment.topic.topicurl %}">
                    {{ comment.topic.title }}
                </a>
                <span class="flex items-center gap-1">
                    {% if comment.topic.section.slug == "filmy" %}
                        <span class="movies">&#127916; Filmy</span>
                    {% elif comment.topic.section.slug == "knihy" %}
                        <span class="books">&#128214; Knihy</span>
                    {% elif comment.topic.section.slug == "hry" %}
                        <span class="games">&#127918; Hry</span>
                    {% elif comment.topic.section.slug == "obecne" %}
                        <span class="text-gray-600">&#128172; Ostatní</span>
                    {% endif %}
                </span>
            </li>
            <hr style="width: 98%; margin: 0 auto;">
            <!-- Info o komentáři -->
            <li>
                <small>
                    <strong>{{ comment.user.username|default:"Smazaný uživatel" }}</strong> · 
                    {{ comment.createdat|date:"d.m.Y H:i" }}
                </small>
                <p class="mt-1 text-sm text-gray-700 dark:text-gray-300">
                    {{ comment.body|striptags|truncatechars:120 }}
                </p>
            </li>
        </ol>
        {% endfor %}
    {% else %}
        <p>Zatím žádné příspěvky.</p>
    {% endif %}
</section>




{% endblock content %}

{% block script %}
<script src="/static/js/forum-comment-summernote.js"></script>
{% endblock script %}
