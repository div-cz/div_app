{% extends "charts/base.html" %}
{% load i18n %}
{% load ratings %}
{% load static %}

{% block title %}Žebříčky uživatelů | DIV.cz{% endblock %}

{% block content %}

<h2 class="w-full"><a href="{% url 'charts_index' %}">Žebříčky</a> / Uživatelé</h2>

<!-- Podkategorie záložek (hodnocení, herci atd.) -->
<div class="row mt-5">
    <ul class="nav nav-tabs overflow-scroll">
        <li class="nav-tabs-item">
            <a class="nav-tabs-link border active" 
            href="#nejaktivnejsi" id="tab-hodnoceni">Nejaktivnější</a> <!-- nejvíce hodnocení -->
        </li>
        <li class="nav-tabs-item">
            <a class="nav-tabs-link border" 
            href="#recenzent" id="tab-recenzent">Recenzent</a> <!-- nejvíce komentářů -->
        </li>
        <li class="nav-tabs-item">
            <a class="nav-tabs-link border" 
            href="#oblibeny" id="tab-oblibeny">Nejoblíbenější</a> <!-- má nejvíce sledovatelů -->
        </li>
        <!-- <li class="nav-tabs-item">
            <a class="nav-tabs-link border" 
            href="#" id="tab-"></a>
        </li>
        <li class="nav-tabs-item">
            <a class="nav-tabs-link border" 
            href="#" id="tab-"></a>
        </li> -->
        <li class="nav-tabs-item">
            <a class="nav-tabs-link border" 
            href="#" id="tab-divcoiny">DIVcoiny</a> <!-- nejvíce DIVcoinů -->
        </li>
    </ul>

    <div class="tab-content w-full mb-3 bg-[#F9F9F9] dark:bg-[#1A161F]">

        <!-- Tab Nejaktivnější -->
        <div id="nejaktivnejsi" class="tab-show w-full sx:p-0 active {% if not hash or hash == 'nejaktivnejsi' %}active{% else %}hidden{% endif %}">
            <h3 class="after-h3 sx:padding">Uživatelé s nejvíce hodnoceními</h3>
            <div class="table lg:pr-5">
                <div class="grid items-center p-1 border sudy">
                    <div class="users">
                        <p><a href="/uzivatel/{{ user.id }}">1. {{ user.username }}</a></p>
                        <p>počet hodnocení</p>
                    </div>
                </div>

                <div class="grid items-center p-1 border sudy">
                    <div class="users">
                        <p><a href="/uzivatel/{{ user.id }}">2. {{ user.username }}</a></p>
                        <p>počet hodnocení</p>
                    </div>
                </div>

                <div class="grid items-center p-1 border sudy">
                    <div class="users">
                        <p><a href="/uzivatel/{{ user.id }}">3. {{ user.username }}</a></p>
                        <p>počet hodnocení</p>
                    </div>
                </div>

                <div class="grid items-center p-1 border sudy">
                    <div class="users">
                        <p><a href="/uzivatel/{{ user.id }}">4. {{ user.username }}</a></p>
                        <p>počet hodnocení</p>
                    </div>
                </div>

                <div class="grid items-center p-1 border sudy">
                    <div class="users">
                        <p><a href="/uzivatel/{{ user.id }}">5. {{ user.username }}</a></p>
                        <p>počet hodnocení</p>
                    </div>
                </div>

                <div class="grid items-center p-1 border sudy">
                    <div class="users">
                        <p><a href="/uzivatel/{{ user.id }}">10. {{ user.username }}</a></p>
                        <p>počet hodnocení</p>
                    </div>
                </div>

            </div>
        </div>

        <!-- Tab Recenzér -->
        <div id="recenzent" class="tab-show w-full sx:p-0 active {% if not hash or hash == 'recenzent' %}active{% else %}hidden{% endif %}">
            <h3 class="after-h3 sx:padding">Uživatelé s nejvíce komentáři</h3>
            <div class="table lg:pr-5">
                <div class="grid items-center p-1 border sudy">
                    <div class="users">
                        <p><a href="/uzivatel/{{ user.id }}">1. {{ user.username }}</a></p>
                        <p>počet komentářů</p>
                    </div>
                </div>

                <div class="grid items-center p-1 border sudy">
                    <div class="users">
                        <p><a href="/uzivatel/{{ user.id }}">2. {{ user.username }}</a></p>
                        <p>počet komentářů</p>
                    </div>
                </div>

                <div class="grid items-center p-1 border sudy">
                    <div class="users">
                        <p><a href="/uzivatel/{{ user.id }}">3. {{ user.username }}</a></p>
                        <p>počet komentářů</p>
                    </div>
                </div>

                <div class="grid items-center p-1 border sudy">
                    <div class="users">
                        <p><a href="/uzivatel/{{ user.id }}">4. {{ user.username }}</a></p>
                        <p>počet komentářů</p>
                    </div>
                </div>

                <div class="grid items-center p-1 border sudy">
                    <div class="users">
                        <p><a href="/uzivatel/{{ user.id }}">5. {{ user.username }}</a></p>
                        <p>počet komentářů</p>
                    </div>
                </div>

                <div class="grid items-center p-1 border sudy">
                    <div class="users">
                        <p><a href="/uzivatel/{{ user.id }}">10. {{ user.username }}</a></p>
                        <p>počet komentářů</p>
                    </div>
                </div>

            </div>
        </div>

        <!-- Tab Nejoblíbenější -->
        <div id="oblibeny" class="tab-show w-full sx:p-0 active {% if not hash or hash == 'oblibeny' %}active{% else %}hidden{% endif %}">
            <h3 class="after-h3 sx:padding">Nejoblíbenější uživatelé</h3>
            <div class="table lg:pr-5">
                <div class="grid items-center p-1 border sudy">
                    <div class="users">
                        <p><a href="/uzivatel/{{ user.id }}">1. {{ user.username }}</a></p>
                        <p>počet uživatelů</p>
                    </div>
                </div>

                <div class="grid items-center p-1 border sudy">
                    <div class="users">
                        <p><a href="/uzivatel/{{ user.id }}">2. {{ user.username }}</a></p>
                        <p>počet uživatelů</p>
                    </div>
                </div>

                <div class="grid items-center p-1 border sudy">
                    <div class="users">
                        <p><a href="/uzivatel/{{ user.id }}">3. {{ user.username }}</a></p>
                        <p>počet uživatelů</p>
                    </div>
                </div>

                <div class="grid items-center p-1 border sudy">
                    <div class="users">
                        <p><a href="/uzivatel/{{ user.id }}">4. {{ user.username }}</a></p>
                        <p>počet uživatelů</p>
                    </div>
                </div>

                <div class="grid items-center p-1 border sudy">
                    <div class="users">
                        <p><a href="/uzivatel/{{ user.id }}">5. {{ user.username }}</a></p>
                        <p>počet uživatelů</p>
                    </div>
                </div>

                <div class="grid items-center p-1 border sudy">
                    <div class="users">
                        <p><a href="/uzivatel/{{ user.id }}">10. {{ user.username }}</a></p>
                        <p>počet uživatelů</p>
                    </div>
                </div>

            </div>
        </div>

        <!-- Tab DIVcoiny -->
        <div id="divcoiny" class="tab-show w-full sx:p-0 active">
            <h3 class="after-h3 sx:padding">Uživatelé s nejvíce DIVcoiny</h3>
            <div class="table lg:pr-5">
                {% for udc in top_users %}
                <div class="grid items-center p-1 border charts-grid sudy">
                    <div class="card-body w-full bg-[#F9F9F9] dark:bg-[#1A161F] rounded-1xl">
                        <div class="users">
                            <p><a href="/uzivatel/{{ udc.user.id }}">{{ forloop.counter }}. {{ udc.user.username }}</a></p>
                            <p>počet DIVcoinů: {{ udc.totaldivcoins }} DIV</p> 
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>

    

        </div>

    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Funkce na aktivaci konkrétního tabu
            function activateTab(tabId) {
                document.querySelectorAll('.tab-show').forEach(tabContent => {
                    tabContent.classList.add('hidden'); // Schovat všechny taby
                    tabContent.classList.remove('active'); // Deaktivovat všechny taby
                });
                document.querySelectorAll('.nav-tabs-link').forEach(tab => {
                    tab.classList.remove('active'); // Deaktivovat všechny odkazy
                });
                const targetTab = tabId.replace('tab-', '');
                document.getElementById(targetTab).classList.add('active');
                document.getElementById(targetTab).classList.remove('hidden');
                document.getElementById('tab-' + targetTab).classList.add('active');
            }


        // Kontrola, jestli je v URL fragment (část po #)
        const hash = window.location.hash.substring(1);  // Získá fragment bez #
        if (hash) {
            activateTab('tab-' + hash);  // Aktivuje příslušný tab
        }

        // Přepínání tabů po kliknutí
        document.querySelectorAll('.nav-tabs-link').forEach(tab => {
            tab.addEventListener('click', function(e) {
                e.preventDefault();
                const targetTab = this.getAttribute('id');
                activateTab(targetTab);
                // Aktualizace URL bez reloadu stránky
                history.pushState(null, null, '#' + targetTab.replace('tab-', ''));
            });
        });
    });
</script>

{% endblock %}