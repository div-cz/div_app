<!DOCTYPE html>
<html lang="cs">
    
    <head>
        {% include "inc/head.html" %}

        <title>DIV.cz | Databáze filmů, knih a her DIV</title>

        <link href="/static/css/index.css" rel="stylesheet">
        <link href="/static/css/navbar_other.css" rel="stylesheet">
        <link href="/static/css/navbar.css" rel="stylesheet">
        <link href="/static/css/hodnoceni.css" rel="stylesheet">

        <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>

        <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/slick-carousel/slick/slick.css"/>
        <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/slick-carousel/slick/slick-theme.css"/>
        <script src="https://cdn.jsdelivr.net/npm/slick-carousel/slick/slick.min.js"></script>

        {% include "inc/google.html" %}

        <meta name="description" content="Objevujte a hodnoťte knihy, hry i filmy na DIV.cz. Připojte se k naší komunitě a získejte přístup k obsahu, recenzím a hodnocením.">
        
        <!-- Open Graph Meta Tags -->
        <meta property="og:title" content="DIV.cz | Databáze filmů, her a knih DIV">
        <meta property="og:description" content="Objevujte a hodnoťte knihy, hry i filmy na DIV.cz. Připojte se k naší komunitě a získejte přístup k obsahu, recenzím a hodnocením.">
        <meta property="og:image" content="https://div.cz/img/movie/filmovy-div.webp">
        <meta property="og:url" content="https://div.cz">
        <meta property="og:type" content="website">
        <meta property="og:site_name" content="DIV.cz">
        
        <!-- Twitter Meta Tags -->
        <meta name="twitter:card" content="summary_large_image">
        <meta name="twitter:title" content="DIV.cz | Databáze filmů, her a knih DIV">
        <meta name="twitter:description" content="Objevujte a hodnoťte filmy, hry a knihy na DIV.cz. Připojte se k naší komunitě a získejte přístup k obsahu, recenzím a hodnocením.">
        <meta name="twitter:image" content="https://div.cz/img/movie/filmovy-div.webp">
        <meta name="twitter:site" content="@DIV_cz">
        <meta name="twitter:creator" content="@DIV_cz">

        <link rel="apple-touch-icon" href="/static/img/site/apple-touch-icon.png">
        <link rel="apple-touch-icon" sizes="57x57" href="/static/img/site/apple/apple-touch-icon-57x57.png">
        <link rel="apple-touch-icon" sizes="72x72" href="/static/img/site/apple/apple-touch-icon-72x72.png">
        <link rel="apple-touch-icon" sizes="76x76" href="/static/img/site/apple/apple-touch-icon-76x76.png">
        <link rel="apple-touch-icon" sizes="114x114" href="/static/img/site/apple/apple-touch-icon-114x114.png">
        <link rel="apple-touch-icon" sizes="120x120" href="/static/img/site/apple/apple-touch-icon-120x120.png">
        <link rel="apple-touch-icon" sizes="144x144" href="/static/img/site/apple/apple-touch-icon-144x144.png">
        <link rel="apple-touch-icon" sizes="152x152" href="/static/img/site/apple/apple-touch-icon-152x152.png">
        
        <meta name="msapplication-square70x70logo" content="/static/img/site/microsoft/div_70.png">
        <meta name="msapplication-square150x150logo" content="/static/img/site/microsoft/div_150.png">
        <meta name="msapplication-wide310x150logo" content="/static/img/site/microsoft/div_310x150.png">
        <meta name="msapplication-square310x310logo" content="/static/img/site/microsoft/div_310.png">
        <meta name="msapplication-TileImage" content="/static/img/site/microsoft/div_152.png">
        <meta name="msapplication-TileColor" content="#FFFFFF"> 
        <meta name="msapplication-TileColor" content="#da532c">
        <meta name="theme-color" content="#ffffff">

        <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css">

        <script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>

        <style>
            .button-next,
            .button-prev {
                z-index: 10;
            }

            .button-next:after, .button-prev:after {
                font-family: swiper-icons;
                font-size: 20px;
                text-transform: none !important;
                letter-spacing: 0;
                font-variant: initial;
                line-height: 1;
                color: #607d8b;
            }

            .button-prev {
                height: 100%;
                top: 0;
                box-shadow: 10px 0px 20px 0px #f8f8f8;
            }

            .button-prev:is(.dark *) {
                box-shadow: 10px 0px 20px 0px #1a161f;
            }

            .button-next {
                height: 100%;
                top: 0;
                box-shadow: -10px 0px 20px 0px #f8f8f8;
            }

            .button-next:is(.dark *) {
                box-shadow: -10px 0px 20px 0px #1a161f;
            }

            .button-next, .button-prev {
                align-items: center;
                color: #007aff;
                cursor: pointer;
                display: flex;
                height: 44px;
                justify-content: center;
                position: absolute;
                width: 36px;
                z-index: 10;
                height: 100%;
            }
            
            .button-next, .button-prev {
                svg {
                    height: 20px;
                    object-fit: contain;
                    transform-origin: center;
                    width: 100%;
                    fill: currentColor;
                    pointer-events: none;
                }
            }
            
            /* Vylepšení zobrazení pagination */
            .swiper-pagination {
                position: absolute;
                bottom: 10px;
                left: 50%;
                transform: translateX(-50%);
            }

            .swiper-button-next {
                left: auto;
                right: 4px;
            }

            .swiper-pagination-bullet {
                height: 13px;
                width: 13px;
                opacity: 0.5;
                background: #607d8b;
            }

            .swiper-pagination-bullet-active {
                opacity: 1;
            }

            .swiper-horizontal {
                &.swiper-rtl .button-prev, &.swiper-rtl~.swiper-button-prev, &~.swiper-button-next, .swiper-button-next {
                    left: auto;
                    right: var(--swiper-navigation-sides-offset, 4px);
                }
            }

            .swiper-horizontal {
                .swiper-button-next, .swiper-button-prev, ~.swiper-button-next, ~.swiper-button-prev {
                    margin-left: 0;
                    margin-top: calc(0px - var(--swiper-navigation-size) / 2);
                    top: 0;
                }
            }

            .button-next svg path,
            .button-prev svg path {
                stroke: currentColor;
                stroke-width: 2;
            }

            .card .card-body .card .card-body:is(.dark *) {
                background: #0d0c0f;
            }

        </style>

    </head>

    <body>

        {% include "inc/navbar_index.html" %}

        <main>
            <section>
                
                {% include "inc/sidebar.html" %}
                
                <div class="container">
                    <!-- LEVÁ STRANA-->
                    <div class="left-side">
                        <!-- carousel -->
                        <div class="carousel-container-index">
                            <div id="films-carousel" class="carousel-index carousel-fade">
                                <div class="carousel-track-index" data-offset="0">
                                    <div class="carousel-item-index">
                                        <a href="https://div.cz/knihy/">
                                            <img src="https://div.cz/img/book/knizni-div.webp" alt="Knihy na DIV.cz">
                                            <h5>Svět knih, her a filmů</h5>
                                        </a>
                                    </div>        
                                    <div class="carousel-item-index">
                                        <a href="">
                                            <img src="https://div.cz/img/game/herni-div.webp" alt="Hry na DIV.cz">
                                            <h5>Svět her</h5>
                                        </a>
                                    </div>
                                    <div class="carousel-item-index">
                                        <a href="https://div.cz/filmy/">
                                            <img src="https://div.cz/img/movie/filmovy-div.webp" alt="">
                                                <h5>Filmový svět</h5>
                                        </a>
                                    </div>
                                    <div class="carousel-item-index">
                                        <a href="">
                                            <img src="https://cdn1.epicgames.com/salesEvent/salesEvent/EGS_RiseoftheTombRaider20YearCelebration_CrystalDynamics_S1_2560x1440-3bd5b3c4c11d46cc2dcb06bdf2f77627" alt="">
                                            <h5></h5>
                                        </a>
                                    </div>
                                    <div class="carousel-item-index">
                                        <a href="">
                                            <img src="https://prh.imgix.net/articles/top10-fiction-1600x800.jpg" alt="">
                                            <h5></h5>
                                        </a>
                                    </div>
                                    <div class="carousel-item-index">
                                        <a href="">
                                            <img src="https://i.ibb.co/R66Zgzz/koc48dky-c3batoc48dc3ad-rec.webp" alt="">
                                            <h5></h5>
                                        </a>
                                    </div>
                                    <div class="carousel-item-index">
                                        <a href="">
                                            <img src="https://ctfs.ceskatelevize.cz/porady-s3/64884c0340b628ecc30d009b/card/bod-obnovy-1692031353725.jpg" alt="">
                                            <h5></h5>
                                        </a>
                                    </div>
                                    <div class="carousel-item-index">
                                        <a href="">
                                            <img src="https://basecamplive.com/wp-content/uploads/2023/02/books.jpeg" alt="">
                                            <h5></h5>
                                        </a>
                                    </div>
                                    <div class="carousel-item-index">
                                        <a href="/film/tancuj-matyldo">
                                            <img src="https://www.themoviedb.org/t/p/w1066_and_h600_bestv2//xWuWxb6N3pwAMw1EqI7So8gHtcL.jpg" alt="">
                                            <h5>Tancuj Matydlo</h5>
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>

                        {% if messages %}
                            <div style="margin-top: .75rem;">
                            {% for message in messages %}
                                <div class="alert alert-{{ message.tags }}" role="alert">
                                    {{ message|safe }}
                                </div>
                            {% endfor %}
                            </div>
                        {% endif %}

                        <div class="info-card">
                            <div class="card">
                                <div class="card-body">
                                    <p style="text-align: center;">
                                        DIV.cz je stránka, která propojuje <a href="/knihy/">knihy</a>, <a href="/filmy/">filmy</a> a <a href="/hry/">hry</a> skrze postavy, lokality a
                                        další prvky.
                                    </p>
                                </div>
                            </div>

                            <!-- VÝPLATA -->
                            {% if pending_payouts_list and user.is_superuser and user.username == "Martin" %}
                            <div class="card">
                                <div class="card-body">
                                    <h3>Výplata pro prodejcee (přehled pro superuser)</h3>
                                    <div class="payment">
                                        {% for user_request in pending_payouts_list%}
                                        <div class="payment-body">
                                            <div>
                                                <p style="font-weight: 700; margin-bottom: .25rem;">
                                                    Prodávající: {{ user_request.user_name|default:user_request.username }}
                                                    <br>
                                                    Číslo účtu: {{ bank_account}}
                                                </p>
                                                <img src="data:image/png;base64,{{ request_qr_code }}" alt="QR Kód pro platbu" style="width: 192px;">
                                                <p style="font-size: 0.875rem; line-height: 1.25rem;">
                                                    Celková částka k vyplacení:
                                                    <span style="font-weight: 600;">
                                                        {{ user_request.total_amount }} Kč
                                                    </span>
                                                </p>
                                            </div>
                                            <form method="post" style="margin-left: 1rem;">
                                                {% csrf_token %}
                                                <input type="hidden" name="user_id" value="{{ user_request.user }}">
                                                <button type="submit" name="confirm_user_payment" class="btn btn-primary">
                                                    Potvrdit vyplacení
                                                </button>
                                            </form>
                                        </div>
                                        {% endfor %}
                                    </div>
                                </div>
                            </div>
                            {% endif %}

                            <!-- objednávky potvrzení -->
                            {% if user.is_authenticated %}
                            <!-- Poslední nákupy eKnih -->
                            {% if user.is_superuser and last_ebook_purchases %}
                            <div class="card">
                                <div class="card-body">
                                <h3>Poslední nákupy eKnih (přehled pro superuser)</h3>
                                <ul>
                                    {% for purchase in last_ebook_purchases %}
                                        <li>
                                            {{ purchase.user.username }} koupil {{ purchase.book.titlecz }} - {{ purchase.status }}
                                        </li>
                                    {% endfor %}
                                </ul>
                                </div>
                            </div>
                            {% endif %}

                            <!-- Moje nákupy v DIVkvariátu -->
                            {% if pending_book_purchases %}
                            <div class="card">
                                <div class="card-body">
                                    <h3>Moje nákupy v DIVkvariátu</h3>
                                    <ul>
                                        {% for listing in pending_book_purchases %}
                                            <li>
                                                {{ listing.book.titlecz }} - Čeká na platbu
                                                <br>
                                                <img src="{% url 'show_qr_payment' listing.id %}" alt="QR kód pro platbu">
                                            </li>
                                        {% endfor %}
                                    </ul>
                                </div>
                            </div>
                            {% endif %}

                            <!-- Moje prodeje v DIVkvariátu -->
                            {% if my_active_actions %}
                            <div class="card">
                                <div class="card-body">
                                    <h3>Moje obchody, které čekají na akci</h3>
                                    <ul style="width: 100%;">
                                    {% for listing in my_active_actions %}
                                        <li class="after last-line">
                                            <div class="my-market">
                                                <!-- Obrázek knihy -->
                                                <div style="width:80px; margin-right: 1rem;">
                                                    {% if listing.book.img == "noimg.png" %}
                                                        <img src="/static/img/book/book.png">
                                                    {% elif listing.book.img == "GoogleID" %}
                                                        <img src="https://books.google.com/books/content?id={{ listing.book.googleid }}&printsec=frontcover&img=1&zoom=1">
                                                    {% else %}
                                                        <img src="https://media.div.cz/knihy/{{ listing.book.img }}">
                                                    {% endif %}
                                                </div>

                                                <!-- Info -->
                                                <div class="my-market-info">
                                                    <a href="{% url 'listing_detail_sell' book_url=listing.book.url listing_id=listing.booklistingid %}" style="margin-left: .25rem;">
                                                    {{ listing.book.titlecz|default:listing.book.title }}
                                                    </a>
                                                    <br>
                                                    <span>
                                                        Role: {% if listing.user == request.user %}Prodejce{% else %}Kupující{% endif %}
                                                    </span>
                                                    <br>
                                                    <span>
                                                        Datum: {{ listing.createdat|date:"j. n. Y" }}
                                                    </span>
                                                    <br>
                                                    <span>
                                                        Cena: {% if listing.price %}{{ listing.price }} Kč{% else %}0 Kč{% endif %}
                                                        {% if listing.shipping %}+ {{ listing.shipping }} Kč poštovné{% endif %}
                                                    </span>
                                                    <br>

                                                    <!-- Výzvy k akci -->
                                                    {% if listing.status == 'RESERVED' and listing.buyer == request.user %}
                                                        <a href="{% url 'listing_detail_sell' book_url=listing.book.url listing_id=listing.booklistingid %}"
                                                        class="movies">
                                                        Čeká se na zaplacení
                                                        </a>
                                                    {% elif listing.status == 'PAID' and listing.user == request.user %}
                                                        <a href="{% url 'listing_detail_sell' book_url=listing.book.url listing_id=listing.booklistingid %}"
                                                        class="books">
                                                        Kupující zaplatil – odešlete knihu
                                                        </a>
                                                    {% elif listing.status in 'PAID' and listing.buyer == request.user %}
                                                        <a href="{% url 'listing_detail_sell' book_url=listing.book.url listing_id=listing.booklistingid %}"
                                                        class="games">
                                                        Čekáme na doručení knihy
                                                        </a>
                                                    {% elif listing.status in 'SHIPPED' and listing.buyer == request.user %}
                                                        <a href="{% url 'listing_detail_sell' book_url=listing.book.url listing_id=listing.booklistingid %}"
                                                        class="games">
                                                        Čekáme na doručení knihy
                                                        </a>
                                                    {% elif listing.status in 'SHIPPED' and listing.user == request.user %}
                                                        <a href="{% url 'listing_detail_sell' book_url=listing.book.url listing_id=listing.booklistingid %}"
                                                        class="games">
                                                        Čekáme na potvrzení převzetí
                                                        </a>
                                                    {% elif listing.status == 'COMPLETED' and listing.user == request.user and not listing.buyerrating %}
                                                        <a href="{% url 'listing_detail_sell' book_url=listing.book.url listing_id=listing.booklistingid %}"
                                                        class="badges">
                                                        Ohodnoťte kupujícího
                                                        </a>
                                                    {% elif listing.status == 'COMPLETED' and listing.buyer == request.user and not listing.sellerrating %}
                                                        <a href="{% url 'listing_detail_sell' book_url=listing.book.url listing_id=listing.booklistingid %}"
                                                        class="badges">
                                                        Ohodnoťte prodejce
                                                        </a>
                                                    {% endif %}
                                                </div>
                                            </div>
                                        </li>
                                    {% endfor %}
                                    </ul>
                                </div>
                            </div>
                            {% endif %}

                            <!-- Moje eKnihy -->
                            {% if user_ebook_purchases %}
                            <div class="card">
                                <div class="card-body">
                                    <h3>Moje eKnihy</h3>
                                    <ul>
                                        {% for purchase in user_ebook_purchases %}
                                            <li><a href="/kniha/{{ purchase.book.url }}">
                                                {{ purchase.book.titlecz|default:purchase.book.title }} <small>(Formát: {{ purchase.format }})</small> </a>
                                                {% if purchase.status == "PENDING" %}
                                                    <form method="POST" action="{% url 'cancel_purchase' purchase.purchaseid %}">
                                                        {% csrf_token %}
                                                        <input type="text" name="cancel_reason" placeholder="Důvod storna">
                                                        <button type="submit">Stornovat</button>
                                                    </form>
                                                {% endif %}
                                            </li>
                                        {% endfor %}
                                    </ul><hr>Všechny najdeš v <a href="/uzivatel/">profilu</a>
                                </div>
                            </div>
                            {% endif %}

                            {% endif %}

                            <!--Moje potávky v div kvariátu-->
                            {% if user_wanted_purchases  %}
                            <div class="card">
                                <div class="card-body">
                                    <h3>Moje poptávky v DIVkvariátu</h3>
                                    <ul style="width: 100%;">
                                        {% for listing in user_wanted_purchases %}
                                        <li class="after last-line">
                                            <div class="my-market"> 
                                                <!-- Obrázek knihy -->
                                                <div style="width:80px; margin-right: 1rem;">
                                                    {% if listing.book.img == "noimg.png" %}
                                                        <img src="/static/img/book/book.png" alt="Kniha {{ listing.book.titlecz }}">
                                                    {% elif  listing.book.img == "GoogleID" %}
                                                        <img src="https://books.google.com/books/content?id={{ listing.book.googleid }}&printsec=frontcover&img=1&zoom=1&edge=curl&source=gbs_api" alt="{{ listing.book.titlecz }}" class="img-fluid">
                                                    {% else %}
                                                        <img src="https://media.div.cz/knihy/{{ listing.book.img }}" alt="{{ listing.book.titlecz }}">
                                                    {% endif %}
                                                </div>
                                
                                                <!-- Info -->
                                                <div class="my-market-info">
                                                    <a href="{% url 'listing_detail_sell' book_url=listing.book.url listing_id=listing.booklistingid %}">{{ listing.book.titlecz }}</a>
                                                    <div>
                                                        <span class="
                                                            {% if listing.status == 'ACTIVE' %} books
                                                            {% elif listing.status == 'RESERVED' %} movies
                                                            {% elif listing.status == 'COMPLETED' %} games
                                                            {% else %}{% endif %}">
                                                            Status: {{ listing.get_status_display }}
                                                        </span>
                                                    </div>
                                                    <span><small>Datum vytvoření: {{ listing.createdat }}</small></span>
                                                </div>

                                                <div class="my-market-price"> 
                                                    <span> Cena: {{ listing.price }} Kč </span>
                                                </div>
                                            </div>
                                        </li>
                                        {% endfor %}
                                    </ul>
                                </div>
                            </div>
                            {% endif %}

                            <!-- carousel filmy -->
                            <div class="card">
                                <div class="card-body">
                                    <h3 class="card-title after-h3">Ze světa filmů</h3>
                                    <div class="swiper">
                                        <div class="card-wrapper">
                                            <div class="card-list swiper-wrapper">
                                                {% for item in movies_carousel %}
                                                <div class="card-item swiper-slide">
                                                    <!-- hodnocení -->
                                                    <div class="carousel-ratting">
                                                        <div class="rating" data-rating="{{ item.real_rating }}">
                                                            <div class="rating-inner">
                                                                {{ item.real_rating }}%
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <a href="/film/{{ item.url }}" class="card-link">
                                                        <img src="https://image.tmdb.org/t/p/w300_and_h450_bestv2{{ item.img }}" class="card-image" alt="{{ item.title }}">
                                                    </a>
                                                    <p>
                                                        <small>{{ item.title }}</small>
                                                    </p>
                                                </div>
                                                {% endfor %}
                                            </div>
                                            
                                            <div class="swiper-pagination"></div>
                                            <div class="swiper-slide-button swiper-button-prev button-prev"></div>
                                            <div class="swiper-slide-button swiper-button-next button-next"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- carousel seriály -->
                            <div class="card">
                                <div class="card-body">
                                    <h3 class="card-title after-h3">Ze světa seriálů</h3>
                                    <div class="swiper">
                                        <div class="card-wrapper">
                                            <div class="card-list swiper-wrapper">
                                                {% for item in series_carousel %}
                                                <div class="card-item swiper-slide">
                                                    <!-- hodnocení -->
                                                    <div class="carousel-ratting">
                                                        <div class="rating" data-rating="{{ item.real_rating }}">
                                                            <div class="rating-inner">
                                                                {{ item.real_rating }}%
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <a href="/serial/{{ item.url }}" class="card-link">
                                                        <img src="https://image.tmdb.org/t/p/w300_and_h450_bestv2/{{ item.img }}" class="card-image" alt="{{ item.title }}">
                                                    </a>
                                                    <p>
                                                        <small>{{ item.title }}</small>
                                                    </p>
                                                </div>
                                                {% endfor %}
                                            </div>
                                            
                                            <div class="swiper-pagination"></div>
                                            <div class="swiper-slide-button swiper-button-prev button-prev"></div>
                                            <div class="swiper-slide-button swiper-button-next button-next"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- carousel knihy -->
                            <div class="card">
                                <div class="card-body">
                                    <h3 class="card-title after-h3">Ze světa knih</h3>
                                    <div class="swiper">
                                        <div class="card-wrapper">
                                            <div class="card-list swiper-wrapper">
                                                {% for item in books_carousel %}
                                                <div class="card-item swiper-slide">
                                                    <!-- hodnocení -->
                                                    <div class="carousel-ratting">
                                                        <div class="rating" data-rating="{{ item.real_rating }}">
                                                            <div class="rating-inner">
                                                                {{ item.real_rating }}%
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <a href="/kniha/{{ item.url }}" class="card-link">
                                                        <img src="https://media.div.cz/knihy/{{ item.img }}" class="card-image" alt="{{ item.title }}">
                                                    </a>
                                                    {% if item.author %}
                                                    <p>
                                                        <small>{{ item.author }}</small>
                                                    </p>
                                                    {% endif %}
                                                    <p>
                                                        <small>{{ item.title }}</small>
                                                    </p>
                                                </div>
                                                {% endfor %}
                                            </div>
                                            
                                            <div class="swiper-pagination"></div>
                                            <div class="swiper-slide-button swiper-button-prev button-prev"></div>
                                            <div class="swiper-slide-button swiper-button-next button-next"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- carousel hry -->
                            <div class="card">
                                <div class="card-body">
                                    <h3 class="card-title after-h3">Ze světa her</h3>
                                    <div class="swiper">
                                        <div class="card-wrapper">
                                            <div class="card-list swiper-wrapper">
                                                {% for item in games_carousel %}
                                                <div class="card-item swiper-slide">
                                                    <!-- hodnocení -->
                                                    <div class="carousel-ratting">
                                                        <div class="rating" data-rating="{{ item.real_rating }}">
                                                            <div class="rating-inner">
                                                                {{ item.real_rating }}%
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <a href="/hra/{{ item.url }}" class="card-link">
                                                        <img src="/static/hra{{ item.img }}" class="card-image" alt="{{ item.title }}">
                                                    </a>
                                                    <p>
                                                        <small>{{ item.title }}</small>
                                                    </p>
                                                </div>
                                                {% endfor %}
                                            </div>
                                            
                                            <div class="swiper-pagination"></div>
                                            <div class="swiper-slide-button swiper-button-prev button-prev"></div>
                                            <div class="swiper-slide-button swiper-button-next button-next"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- novinky -->
                            <div class="card">
                                <div class="card-body">
                                    <h3 class="card-title after-h3">Novinky</h3>

                                    <!-- H O V I N K A    add by M a r t i n  -->
                                    {% if user.is_superuser or user.is_staff %}
                                    <div class="add-content after">
                                        <details>
                                            <!-- Formulář pro přidání novinky -->
                                            <summary style="font-size: 1.17rem;">Přidej novinku</summary>
                                            <form method="POST" class="form">
                                                {% csrf_token %}
                                                <div class="form-group">{{ articlenews_form.title }}
                                                    <label for="id_title">:Titulek</label>
                                                </div>
                                                
                                                <div class="form-group">
                                                    <label for="id_news">Novinka:</label>
                                                    {{ articlenews_form.news }}
                                                </div>
                                                
                                                <div class="form-group">{{ articlenews_form.img }}
                                                    <label for="id_img">:Img (linkovat obrázky z div.cz)</label>
                                                </div>
                                                
                                                <div class="form-group">{{ articlenews_form.alt }}
                                                    <label for="id_alt">:Alt</label>
                                                </div>
                                                
                                                <div class="form-group">{{ articlenews_form.source }}
                                                    <label for="id_source">:Zdroj (Variety.com atp.)</label>
                                                </div>
                                                
                                                <div class="form-group">{{ articlenews_form.typ }}
                                                    <label for="id_typ">:Typ (Movie, Serie, Book, Game)</label>
                                                </div>

                                                <button type="submit" name="articlenews_submit" class="btn btn-primary">Přidat novinku</button>
                                            </form>
                                        </details>
                                    </div>
                                    {% endif %}

                                    <!-- výpis novinek -->
                                    <div class="w-full">
                                        {% for news in articlenews %}
                                        <div class="after last-line">
                                            <h3 class="">{{ news.title }}</h3>
                                            <p class="biography-text">{{ news.news|safe }}</p> 
                                            <p><a class="toggle-biography">Více...</a></p>
                                            <p class="text-end"><small>({{ news.source }} - {{ news.created }})</small></p>
                                        </div>
                                        {% endfor %}
                                    </div>
                                    
                                </div>
                            </div>
                           
                            <!-- Nejnovější komentáře -->
                            <div class="card">
                                <div class="card-body">
                                    <h3 class="card-title after-h3">Nejnovější recenze</h3>     
                                    {% for comment in latest_comments %}
                                    <div class="card">
                                        <div class="card-body">
        
                                            <!-- Tag -->
                                            {% if comment.movieid %}
                                            <p class="comment-head">&#127916;
                                                <a href="/film/{{ comment.movieid.url }}">
                                                    {{ comment.movieid.titlecz }}
                                                </a>
                                            </p>

                                            {% elif comment.bookid %}
                                            <p class="comment-head">&#128214;
                                                <a href="/kniha/{{ comment.bookid.url }}">
                                                    {{ comment.bookid.titlecz }}
                                                </a>
                                            </p>

                                            {% elif comment.gameid %}
                                            <p class="comment-head">&#127918;
                                                <a href="/hra/{{ comment.gameid.url }}">
                                                    {{ comment.gameid.titlecz }}
                                                </a>
                                            </p>
                                            {% endif %}

                                            <!-- Text komentáře -->
                                            <p class="comment">{{ comment.comment|truncatewords:20 }}</p>

                                            <!-- Uživatel -->
                                            <div class="user-comment">
                                                <small>Uživatel: 
                                                    <a href="/uzivatel/{{ comment.user.username }}">{{ comment.user.username }}</a>
                                                </small>
                                            </div>
                                        </div>
                                    </div>
                                    {% endfor %}
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- PRAVÁ STRANA -->
                    <div class="right-side">

                        <!-- narozeniny -->
                        <div class="card">
                            <div class="card-body">
                            <h3 class="card-title after-h3">Narozeniny slaví</h3>

                            {% load cache %}
                            {% cache 28800 creators_list_birth %} 
                                {% for creator in creators_list_8 %}
                                <div class="birthday after last-line">
                                    <img src="{% if creator.img == 'noimg.png' %}http://media.div.cz/media/noperson.svg{% else %}https://www.themoviedb.org/t/p/w300/{{ creator.img }}{% endif %}" class="" alt="{{ creator.lastname }}">
                                    <div class="birthday-body">
                                        <h3>
                                            <a href="{% url 'creator_detail' creator.url %}">{{ creator.firstname }} {{ creator.lastname }}</a>
                                        </h3>
                                        <p class="card-text">{{ creator.birthdate|date:"d.m.Y" }}</p>
                                        <p class="card-text">
                                            {% if creator.knownfordepartment == "Acting" %}
                                            Herec
                                            {% elif creator.knownfordepartment == "Directing" %}
                                            Režisér
                                            {% elif creator.knownfordepartment == "Production" %}
                                            Producent
                                            {% elif creator.knownfordepartment == "Writing" %}
                                            Scénárista
                                            {% else %}
                                            Těžko říct
                                            {% endif %}
                                        </p>
                                    </div>
                                </div>
                                {% endfor %}
                            {% endcache %} 
                            <a href="" style="width: 100%; text-align: center;"><small>Zobrazit další</small></a>       
                            </div>
                        </div>

                        <!-- články -->
                        <div class="card">
                            <div class="card-body">
                                <div class="card-title after-h3">
                                    <h3>Články</h3>
                                    <a href="{% url 'articles_index' %}"><small>Zobrazit vše</small></a>
                                </div>

                                {% for article in articles %}
                                <div class="article">
                                {% if article.img1600 %}
                                    <img src="{{ article.img1600 }}" alt="{{ article.title }}">
                                    {% elif article.img %}
                                    <img src="https://image.tmdb.org/t/p/w300_and_h450_bestv2{{ article.img }}" alt="{{ article.title }}">
                                {% endif %}

                                    <div class="article-text">
                                        <a href="{{ article.url }}">{{ article.title }}</a>
                                    </div>
                                </div>
                                {% endfor %}
                            </div>
                        </div>
                        
                        <!-- burza knih -->
                        <div class="card">
                            <div class="card-body">
                                <div class="card-title after-h3">
                                    <h3>Burza knih</h3>
                                </div>
                                <!-- prodej -->
                                <div class="book-market">
                                    <div class="book-market-title">
                                        <h4>Prodej</h4>
                                        <a href="{% url 'books_market_offers' %}"><small>Zobrazit vše</small></a>
                                    </div>
                                    {% for listing in recent_sell_listings %}
                                    <div class="book-market-body">
                                        <a href="{% url 'listing_detail_sell' listing.book.url listing.booklistingid %}">
                                        {% if listing.book.img == "noimg.png" %}
                                            <!-- Pokud je book.img "noimg.png", zobraz výchozí obrázek -->
                                            <img src="/static/img/book/book.png" alt="Kniha {{ listing.book.titlecz }}" alt="odkaz na knihu">
                                            {% elif listing.book.img == "GoogleID" %}
                                            <!-- Pokud je book.img "GoogleID", zobraz náhled z Google Books -->
                                            <img src="https://books.google.com/books/content?id={{ listing.book.googleid }}&printsec=frontcover&img=1&zoom=1&edge=curl&source=gbs_api" alt="{{ listing.book.titlecz }}" alt="odkaz na knihu">
                                            {% else %}
                                            <!-- Jinak zobraz vlastní nahraný obrázek -->
                                            <img src="https://media.div.cz/knihy/{{ listing.book.img }}" alt="{{ listing.book.titlecz }}" alt="odkaz na knihu">
                                        {% endif %}
                                        </a>

                                        <div class="book-market-text">
                                            <p>{{ listing.book.titlecz }}</p>
                                            <p>{{ listing.book.author }}</p>
                                            <p>{% if listing.price %}{{ listing.price|floatformat:0 }} Kč{% else %}Daruji{% endif %}</p>
                                            <p class="book-market-user"><small>Přidal: {{ listing.user.username }} | {{ listing.createdat|date:"j.n.Y" }}</small></p>
                                        </div>
                                    </div>
                                    {% endfor %}
                                </div>

                                <hr>

                                <!-- poptávka -->
                                <div class="book-market">
                                    <div class="book-market-title">
                                        <h4>Poptávka</h4>
                                        <a href="{% url 'books_market_wants' %}"><small>Zobrazit vše</small></a>
                                    </div>
                                    {% for listing in recent_buy_listings %}
                                    <div class="book-market-body">
                                        <a href="{% url 'listing_detail_buy' listing.book.url listing.booklistingid %}">
                                        {% if listing.book.img == "noimg.png" %}
                                            <!-- Pokud je book.img "noimg.png", zobraz výchozí obrázek -->
                                            <img src="/static/img/book/book.png" alt="Kniha {{ listing.book.titlecz }}" alt="odkaz na knihu">
                                            {% elif listing.book.img == "GoogleID" %}
                                            <!-- Pokud je book.img "GoogleID", zobraz náhled z Google Books -->
                                            <img src="https://books.google.com/books/content?id={{ listing.book.googleid }}&printsec=frontcover&img=1&zoom=1&edge=curl&source=gbs_api" alt="{{ listing.book.titlecz }}" alt="odkaz na knihu">
                                            {% else %}
                                            <!-- Jinak zobraz vlastní nahraný obrázek -->
                                            <img src="https://media.div.cz/knihy/{{ listing.book.img }}" alt="{{ listing.book.titlecz }}" alt="odkaz na knihu">
                                        {% endif %}
                                        </a>

                                        <div class="book-market-text">
                                            <p>{{ listing.book.titlecz }}</p>
                                            <p>{{ listing.book.author }}</p>
                                            <p>{% if listing.price %}{{ listing.price|floatformat:0 }} Kč{% else %}Daruji{% endif %}</p>
                                            <p class="book-market-user"><small>Přidal: {{ listing.user.username }} | {{ listing.createdat|date:"j.n.Y" }}</small></p>
                                        </div>
                                    </div>
                                    {% endfor %}
                                </div>
                            </div>
                        </div>

                        <!-- licence her -->
                        <div class="card">
                            <div class="card-body">
                                <h3 class="card-title after-h3">Licence her</h3>
                                <ul>
                                    <li>Playstation Store<!--, kredit 500,--></li>
                                    <li>xBox Store<!--, kredit 1000,--></li>
                                </ul>
                            </div>
                        </div>

                    </div>
                </div>
            </section>
        </main>

        {% include "inc/footer.html" %}

        <!-- více, méně -->
        <script>
            document.addEventListener("DOMContentLoaded", function () {
                const bioElements = document.querySelectorAll(".biography-text");
                const toggleButtons = document.querySelectorAll(".toggle-biography");

                bioElements.forEach((bioElement, index) => {
                    const fullHTML = bioElement.innerHTML; // Celý text včetně HTML
                    const maxLength = 400; // Požadovaný počet znaků

                    // Vytvořit text bez HTML pro zkrácení
                    const tempElement = document.createElement("div");
                    tempElement.innerHTML = fullHTML;
                    const plainText = tempElement.innerText;

                    // Zkrácený text (bez HTML, ale jen do maxLength znaků)
                    const truncatedText = plainText.substring(0, maxLength);

                    // Zkrácený HTML (pro zobrazení s HTML tagy)
                    let truncatedHTML = "";
                    let charCount = 0;
                    tempElement.childNodes.forEach(node => {
                        if (charCount >= maxLength) return; // Nepřidávat další znaky
                        if (node.nodeType === Node.TEXT_NODE) {
                            // Přidat textový obsah
                            const remainingChars = maxLength - charCount;
                            truncatedHTML += node.textContent.substring(0, remainingChars);
                            charCount += node.textContent.length;
                        } else if (node.nodeType === Node.ELEMENT_NODE) {
                            // Přidat celý HTML tag (rekurzivně zpracovaný)
                            const nodeHTML = node.outerHTML;
                            if (charCount + node.textContent.length <= maxLength) {
                                truncatedHTML += nodeHTML;
                                charCount += node.textContent.length;
                            }
                        }
                    });

                    // Přidat tři tečky na konec, pokud je text zkrácený
                    if (plainText.length > maxLength) {
                        truncatedHTML += "...";
                    }

                    // Nastavit zkrácený text
                    bioElement.innerHTML = truncatedHTML;

                    // Pokud má text více než maxLength znaků, přidat funkci na zobrazení plného textu
                    if (plainText.length > maxLength) {
                        toggleButtons[index].style.display = "inline"; // Zobrazit tlačítko
                        toggleButtons[index].addEventListener("click", function () {
                            if (bioElement.innerHTML === truncatedHTML) {
                                bioElement.innerHTML = fullHTML; // Zobrazit celý text
                                this.innerText = "...Méně"; // Změnit text tlačítka
                            } else {
                                bioElement.innerHTML = truncatedHTML; // Zobrazit zkrácený text
                                this.innerText = "Více..."; // Změnit text tlačítka
                            }
                        });
                    } else {
                        toggleButtons[index].style.display = "none"; // Skryjeme tlačítko
                    }
                });
            });
        </script>

        <!-- carousel ze světa... -->
        <script>
            document.addEventListener('DOMContentLoaded', function () {
                new Swiper('.card-wrapper', {
                    loop: true,
                    speed: 700,
                    spaceBetween: 20,  // Menší mezera mezi kartami, pokud je příliš velká
                    slidesPerView: 4,  // Na větších obrazovkách zobrazení 4 karet
                    slidesPerGroup: 1,  // Posouvá se vždy o 1 kartu

                    pagination: {
                        el: '.swiper-pagination',
                        clickable: true,
                        dynamicBullets: true,
                    },

                    navigation: {
                        nextEl: '.button-next',
                        prevEl: '.button-prev',
                    },

                    breakpoints: {
                        0: {
                            slidesPerView: 2,  // Na mobilu 2 karty
                            spaceBetween: 10,  // Menší mezera mezi kartami na mobilu
                        },
                        768: {
                            slidesPerView: 3,  // Na tabletu 3 karty
                            spaceBetween: 15,  // Střední mezera mezi kartami na tabletu
                        },
                        1024: {
                            slidesPerView: 4,  // Na desktopu 4 karty
                            spaceBetween: 20,  // Větší mezera mezi kartami na desktopu
                        },
                    },
                });
            });
        </script>

        {% load static %}
        
        <script src="{% static 'js/script.js' %}"></script>
        <script src="{% static 'js/index.js' %}"></script>

    </body>
</html>